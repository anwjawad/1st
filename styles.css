/* =========================
   Palliative Rounds — Styles (Glass/Neon)
   3 Themes: neon (default), ocean, rose
   High-contrast + glass + smooth transitions
   ========================= */

/* ===== THEME TOKENS =====
   اختر الثيم عبر:
   <body data-theme="neon">   (افتراضي)
   <body data-theme="ocean">
   <body data-theme="rose">
*/

/* --- Default (neon) --- */
:root{
  /* Surfaces */
  --bg:#0b1020;
  --bg-2:#0f162e;
  --bg-3:#111a33;
  --panel: rgba(255,255,255,.08);
  --card:  rgba(255,255,255,.06);
  --card-2:rgba(255,255,255,.08);
  --glass: rgba(255,255,255,.08);
  --border: rgba(255,255,255,.18);

  /* Text */
  --text:#f2f5ff;
  --muted:#a7b0cc;

  /* Accents */
  --primary:#7c5cff;   /* purple */
  --primary-2:#4ec3ff; /* sky */
  --accent:#2de2e6;    /* cyan */
  --danger:#ff5a7a;    /* pink */
  --success:#31d69b;   /* green */
  --warn:#ffc857;      /* amber */

  /* Chips */
  --chip:#181b3a;
  --chip-2: rgba(255,255,255,.08);

  /* Shadows */
  --shadow: 0 12px 40px rgba(0,0,0,.35);
  --shadow-1: 0 8px 28px rgba(0,0,0,.25);

  /* Radii / gaps */
  --radius:18px; --radius-sm:12px; --radius-xs:10px;
  --gap:14px;

  /* ===== Motion control ===== */
  --motion-multiplier: 1;
  --ease-default: cubic-bezier(.2,.7,.2,1);
  --t-fast:160ms; --t-med:220ms; --t-slow:320ms;

  /* Transitions */
  --speed-fast: calc(var(--t-fast) * var(--motion-multiplier)) var(--ease-default);
  --speed-med:  calc(var(--t-med)  * var(--motion-multiplier)) var(--ease-default);
  --speed-slow: calc(var(--t-slow) * var(--motion-multiplier)) var(--ease-default);

  /* Scrollbar */
  --scroll-track: rgba(255,255,255,.06);
  --scroll-thumb: rgba(255,255,255,.22);

  /* Print */
  --print-head-bg:#eee;
}

/* --- Ocean theme --- */
:root[data-theme="ocean"]{
  --bg:#07121b; --bg-2:#0a1a28; --bg-3:#0c2333;
  --panel: rgba(255,255,255,.07); --card: rgba(255,255,255,.05); --card-2:rgba(255,255,255,.07);
  --glass: rgba(255,255,255,.08); --border: rgba(255,255,255,.16);
  --text:#e9f6ff; --muted:#8fb0c8;
  --primary:#29b6f6; --primary-2:#00e5ff; --accent:#4df2c8; --danger:#ff5a7a; --success:#31d69b; --warn:#ffcb57;
  --chip:#173347; --chip-2: rgba(255,255,255,.08);
  --shadow: 0 12px 40px rgba(0,0,0,.35); --shadow-1: 0 8px 28px rgba(0,0,0,.25);
  --scroll-track: rgba(255,255,255,.05); --scroll-thumb: rgba(255,255,255,.20);
  --print-head-bg:#e8f3ff;
}

/* --- Rose theme --- */
:root[data-theme="rose"]{
  --bg:#180d16; --bg-2:#22121f; --bg-3:#2a1626;
  --panel: rgba(255,255,255,.08); --card: rgba(255,255,255,.06); --card-2:rgba(255,255,255,.08);
  --glass: rgba(255,255,255,.09); --border: rgba(255,255,255,.18);
  --text:#fff2f6; --muted:#e0b9c9;
  --primary:#ff6aa2; --primary-2:#ffb86b; --accent:#ffd36e; --danger:#ff4d6d; --success:#49e0a6; --warn:#ffc36b;
  --chip:#3a1b2f; --chip-2: rgba(255,255,255,.08);
  --shadow: 0 12px 40px rgba(0,0,0,.38); --shadow-1: 0 8px 30px rgba(0,0,0,.28);
  --scroll-track: rgba(255,255,255,.06); --scroll-thumb: rgba(255,255,255,.24);
  --print-head-bg:#ffe8f2;
}

/* ===== Base ===== */
*{ box-sizing:border-box }
html, body{ height:100% }
body{
  margin:0; background:linear-gradient(180deg, var(--bg), var(--bg-2));
  color:var(--text); font: 14px/1.5 system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
}
a{ color:inherit; text-decoration:none }
.mono{ font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace }
.small{ font-size:12px }
.muted{ color: var(--muted) }
.linkish{ cursor:pointer }
.hidden{ display:none !important }

/* ===== Scrollbar ===== */
*::-webkit-scrollbar{ width: 10px; height: 10px; }
*::-webkit-scrollbar-track{ background: var(--scroll-track); border-radius: 8px; }
*::-webkit-scrollbar-thumb{ background: var(--scroll-thumb); border-radius: 8px; border: 2px solid transparent; background-clip: padding-box; }
*{ scrollbar-color: var(--scroll-thumb) var(--scroll-track); scrollbar-width: thin; }

/* ===== Containers / Cards / Panels ===== */
.card{
  background: var(--card);
  border:1px solid var(--border);
  border-radius: 16px;
  box-shadow: var(--shadow-1);
}
.card-title{ font-weight:800; letter-spacing:.3px }
.card-head{ padding: 10px 12px; border-bottom:1px solid var(--border); display:flex; align-items:center; gap:8px; justify-content:space-between; }
.card-body{ padding:12px }

/* ===== Header / Topbar ===== */
#topbar{
  position: sticky; top:0; z-index: 1000;
  background: linear-gradient(180deg, color-mix(in oklab, var(--bg) 70%, transparent), transparent);
  border-bottom: 1px solid var(--border);
  backdrop-filter: blur(6px) saturate(120%);
  display:flex; align-items:center; justify-content:space-between; gap:10px; padding:10px 12px;
}
#topbar .brand{ display:flex; gap:10px; align-items:center; }
#topbar .brand .logo{ width:28px; height:28px; border-radius:8px; background: radial-gradient(80% 80% at 60% 40%, var(--primary), var(--primary-2)); box-shadow: inset 0 0 20px rgba(255,255,255,.2); }
#topbar .brand .name{ font-weight:800; letter-spacing:.4px }
#topbar .ops{ display:flex; gap:8px; flex-wrap:wrap }
#topbar .ops .btn{ padding:8px 10px }

/* ===== Columns / Sidebar ===== */
#columns{ display:grid; grid-template-columns: 280px 1fr; gap:14px; padding:14px; }
.sidebar{ position: sticky; top:58px; align-self:start; display:grid; gap:12px; }
.sections{display:flex; flex-direction:column; gap:8px}

.pill{
  background:var(--glass); color:var(--text);
  border:1px solid var(--border); padding:10px 12px; border-radius:12px; cursor:pointer; text-align:left;
  transition: background-color var(--speed-med), border-color var(--speed-med), transform var(--speed-fast), box-shadow var(--speed-slow);
}
.pill:hover{ border-color: var(--primary); transform: translateY(-1px); box-shadow: 0 10px 28px rgba(0,0,0,.25) }
.pill.active{
  background: linear-gradient(135deg, color-mix(in oklab, var(--primary) 20%, transparent), color-mix(in oklab, var(--primary-2) 12%, transparent));
  border-color: color-mix(in oklab, var(--primary) 45%, var(--border));
}
.pill .pill-count{
  float:right; background:var(--chip); padding:2px 8px; border-radius:999px; font-size:12px; border:1px solid var(--border)
}
.pill .pill-count.pulse{ animation: pulse 1.4s ease-in-out infinite }
@keyframes pulse{
  0%,100%{ transform: scale(1); opacity:.9 }
  50%{ transform: scale(1.06); opacity:1 }
}

/* ===== Buttons ===== */
.btn{
  background:var(--glass); color:var(--text); border:1px solid var(--border);
  border-radius:12px; padding:10px 12px; cursor:pointer;
  transition: box-shadow var(--speed-fast), transform var(--speed-fast), background-color var(--speed-med), border-color var(--speed-med);
}
.btn:hover{ transform: translateY(-1px); box-shadow: var(--shadow-1); }
.btn:active{ transform: translateY(0); }
.btn-primary{ background: linear-gradient(135deg, var(--primary), var(--primary-2)); color:white; border-color: transparent; }
.btn-ghost{ background: transparent; }
.icon-btn{ background:transparent; border:1px solid var(--border); border-radius:10px; padding:8px; cursor:pointer; transition: border-color var(--speed-fast), transform var(--speed-fast); }
.icon-btn:hover{ transform: translateY(-1px); }

/* ===== Patients list ===== */
#patients-col .tools{ display:flex; align-items:center; justify-content:space-between; gap:8px; }
#patients-col .list{
  display:grid; gap:10px;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
}

.row{ display:grid; grid-template-columns: 1fr auto; gap:8px; padding:10px; border-radius: 14px; border:1px solid var(--border); background: var(--card); box-shadow: var(--shadow-1); }
.row-title{ font-weight:800; letter-spacing:.3px }
.row-sub{ color: var(--muted) }
.row-tags{ display:flex; gap:6px; flex-wrap:wrap }
.row-tag{
  display:inline-block; background:var(--glass); padding:4px 10px; border-radius:999px; font-size:12px; border:1px solid var(--border)
}
.row-code{font-family:var(--mono); color:#b7c4ff; align-self:center}

.patient-card .row-header{display:flex; align-items:center; justify-content:space-between; gap:10px}
.patient-card .row-tags{margin-top:8px; display:flex; flex-wrap:wrap; gap:6px}
.row-chip{
  display:inline-flex; align-items:center; font-size:12px;
  padding:4px 8px; border-radius:999px; border:1px solid var(--border); background:var(--glass);
}
.row-chip.abn{background: color-mix(in oklab, var(--danger) 12%, var(--glass))}
.row-chip.sym{background: color-mix(in oklab, var(--primary) 12%, var(--glass))}

/* Hover */
.patient-card { transition: transform 0.25s ease, box-shadow 0.25s ease; }
.patient-card:hover { transform: translateY(-3px) scale(1.01); box-shadow: 0 6px 16px rgba(0,0,0,0.25); }

/* ===== Tabs ===== */
.tabs{ display:flex; gap:8px; flex-wrap:wrap; }
.tabs .tab{ background:var(--glass); border:1px solid var(--border); border-radius:12px; padding:8px 10px; cursor:pointer; transition: background-color var(--speed-fast), transform var(--speed-fast) }
.tabs .tab.active{ background: color-mix(in oklab, var(--primary) 14%, var(--glass)); transform: translateY(-1px) }

/* ===== Search ===== */
#search{ min-width: 260px; }

/* ===== Dashboard ===== */
#dashboard-panel[data-empty="true"]{ opacity:.6; filter: grayscale(.15) }
#dashboard-title{ font-weight:800 }

#bio-grid{ display:grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap:10px; }
.field{ display:grid; gap:6px }
.field .label{ font-size:12px; color:var(--muted) }
.field input, .field textarea, .pinput{
  background:var(--glass); border:1px solid var(--border); color:var(--text);
  border-radius:10px; padding:8px 10px; outline: none;
}
.field textarea{ min-height: 68px }
.pinput{ padding:9px 10px }
.pselect{ background:var(--glass); border:1px solid var(--border); color:var(--text); border-radius:10px; padding:8px 10px; }

/* ESAS/CTCAE/Labs/Symptoms grids */
.grid{ display:grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap:10px }
.score-item{ background: var(--glass); border:1px solid var(--border); border-radius: 12px; padding:8px 10px; }
.score-head{ display:flex; align-items:center; justify-content:space-between; gap:8px; }
.score-title{ font-weight:700 }
.score-select{ display:flex; flex-wrap:wrap; gap:4px; }
.score-btn{ border:1px solid var(--border); background:var(--card-2); padding:4px 8px; border-radius:8px; cursor:pointer }
.score-btn.active{ background: color-mix(in oklab, var(--primary) 20%, var(--card-2)); border-color: color-mix(in oklab, var(--primary) 40%, var(--border)); color:white }
.score-note{ margin-top:6px }
.score-item.has-score .score-note{ display:block }
.score-item .score-note{ display:none }

.symptom-chip{
  border:1px solid var(--border); border-radius: 999px;
  padding: 6px 10px; background: var(--chip-2);
  cursor: pointer;
  transition: background-color var(--speed-fast), color var(--speed-fast), transform var(--speed-fast);
}
.symptom-chip.active{
  background: color-mix(in oklab, var(--primary) 18%, var(--chip-2));
  color:#fff;
}

/* ===== Labs ===== */
#labs-grid{ display:grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap:10px }
.lab{ background:var(--glass); border:1px solid var(--border); border-radius:12px; padding:10px }
.lab-head{ display:flex; justify-content:space-between; align-items:center; margin-bottom:6px }
.lab-name{ font-weight:700 }
.lab input{ width:100%; background:var(--card-2); border:1px solid var(--border); color:var(--text); border-radius:8px; padding:6px 8px }
.lab.abnormal-high{ border-color: color-mix(in oklab, var(--danger) 45%, var(--border)); box-shadow: inset 0 0 0 2px color-mix(in oklab, var(--danger) 20%, transparent) }
.lab.abnormal-low{ border-color: color-mix(in oklab, var(--accent) 45%, var(--border)); box-shadow: inset 0 0 0 2px color-mix(in oklab, var(--accent) 20%, transparent) }

#labs-summary{ display:flex; gap:6px; flex-wrap:wrap }
.labs-chip{ font-size:12px; padding:4px 8px; border-radius:999px; background: var(--chip-2); border:1px solid var(--border) }

/* ===== Summaries ===== */
#summaries-root .card pre{ background: var(--card-2); border:1px solid var(--border); border-radius:10px; padding:8px 10px; }

/* ===== Calculators ===== */
.calc-grid{ display:grid; grid-template-columns: 1fr 1fr; gap:10px }
.calc-card{ background: var(--glass); border:1px solid var(--border); border-radius:12px; padding:10px }
.calc-row{ display:flex; gap:8px; flex-wrap:wrap; align-items:center }
.calc-out{ font-family: var(--mono); background: var(--card-2); border:1px solid var(--border); border-radius: 10px; padding:8px 10px }

/* ===== Modal ===== */
.modal{ position:fixed; inset:0; display:flex; align-items:center; justify-content:center; background:rgba(6,8,16,.55); z-index:1500; }
.modal.hidden{display:none}
.modal-card{
  width:min(720px, 92vw); background:var(--panel); border:1px solid var(--border); border-radius:16px;
  box-shadow: var(--shadow); overflow:hidden; transform: translateY(12px); opacity:0;
}
.modal-header, .modal-footer{padding:12px 14px; background: color-mix(in oklab, var(--panel) 85%, transparent); border-bottom:1px solid var(--border)}
.modal-footer{border-top:1px solid var(--border); border-bottom:none; display:flex; gap:8px; justify-content:flex-end}
.modal-body{padding:14px}
.modal-card-full{ width:min(1400px, 96vw); height:94vh; display:flex; flex-direction:column; border-radius:18px; }
.modal-body.modal-body-pad{ padding:18px; overflow:auto; }

/* حركة المودال */
.modal:not(.hidden) .modal-card{ transform: translateY(0); opacity:1; transition: transform var(--speed-med), opacity var(--speed-med); }

/* ===== Import CSV preview ===== */
#csv-preview{ max-height: 38vh; overflow:auto }

/* ===== Export / Print ===== */
#print-root{ display:none }
.print-page{ page-break-after: always; padding:12px }
.print-head{ background: var(--print-head-bg); padding:8px 10px; border-radius:8px; }
.print-title{ font-weight:800 }
.print-sub{ color:#333; opacity:.7 }

.print-table{ width:100%; border-collapse: collapse; }
.print-table th, .print-table td{ border:1px solid #ccc; padding:6px 8px; text-align:left; vertical-align:top; }
.print-table thead th{ background:#f3f3f3 }

/* ===== Mobile tweaks ===== */
.mobile-only{ display:none; }
@media (max-width: 980px){
  #columns{ grid-template-columns: 1fr; }
  .sidebar{ position: static; }
  .mobile-only{ display: inline-flex; }
  #topbar .ops{ display:none; }
  #topbar input[type="search"]{ min-width: 0; }

  /* Sidebar as drawer */
  body.sidebar-open #columns{ transform: translateX(220px); }
  #columns{ transition: transform var(--speed-med); }

  .scrim{
    position: fixed; inset:0;
    background: rgba(0,0,0,.45);
    backdrop-filter: blur(2px);
    z-index: 1400;
    display:none;
  }
  body.sidebar-open .scrim{ display:block }

  /* FAB */
  .fab{
    position: fixed; right:16px; bottom:16px;
    width:56px; height:56px; border-radius:50%;
    display:none; place-items:center;
    background: linear-gradient(135deg, var(--primary), var(--primary-2)); color:white;
    box-shadow: var(--shadow);
    border: none;
  }
  .fab .mi{ font-size:22px; }
  body.sidebar-open .fab{ display: grid; }
}

/* ===== Animations helpers ===== */
@keyframes slideIn{
  from{ transform: translateY(6px); opacity:0 }
  to  { transform: translateY(0);   opacity:1 }
}
@keyframes pulseFade{
  0%,100%{ opacity: .9 } 50%{ opacity: 1 }
}

/* Smooth fade/slide عند تغيّر الأقسام */
#patients-list { transition: opacity var(--speed-med), transform var(--speed-med); }
#patients-list.enter { opacity: 0; transform: translateY(8px); }
#patients-list.enter-active { opacity: 1; transform: translateY(0); }

/* Reduced motion */
@media (prefers-reduced-motion: reduce){
  * { animation: none !important; transition: none !important; }
}